<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Feud: Ande vs Tom</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main>
    <h1>The Feud: Ande vs Tom</h1>
    <div class="trash-talk" id="trashTalk" aria-live="polite"></div>
    <table id="scoreTable" aria-label="Weekly Scores">
      <thead>
        <tr>
          <th scope="col">Week</th>
          <th scope="col">🔥 Ande “The Fairway Fiend”</th>
          <th scope="col">🎯 Tom “The Tee Terminator”</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="winner" id="winnerDisplay" aria-live="polite"></div>

    <section class="about">
      <h2>👊 Meet the Rivals</h2>
      <div class="rival">
        <img src="https://bustedwallet-chatgpt-public.s3.amazonaws.com/ande.png" alt="Ande - The Fairway Fiend" loading="lazy" />
        <div>
          <strong>🔥 Ande “The Fairway Fiend”</strong><br>
          Known for precision iron play and psychological warfare. Claims he once hit 3 greens in regulation... on a par 3 course. Fueled by protein shakes and petty vengeance.
        </div>
      </div>
      <div class="rival">
        <img src="https://bustedwallet-chatgpt-public.s3.amazonaws.com/tom.png" alt="Tom - The Tee Terminator" loading="lazy" />
        <div>
          <strong>🎯 Tom “The Tee Terminator”</strong><br>
          Drives like a beast, putts like a poet. Once holed a 60-footer just to avoid a tie. May or may not own more polos than golf balls.
        </div>
      </div>
    </section>
  </main>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbw6KhovfKp_JKbe9mR6YtCEDqe_qFAGXPve0_91oHbKOEpKFZFmXNoCDTEwHTjI3u2I/exec';

    // Fetch data from the API
    async function fetchScores() {
      try {
        const res = await fetch(API_URL);
        if (!res.ok) throw new Error('Failed to fetch data');
        const scores = await res.json();
        updateTable(scores);
        calculateWinner(scores);
      } catch (error) {
        console.error('Error fetching scores:', error);
        document.querySelector('#winnerDisplay').textContent = 'Failed to load scores. Please try again later.';
      }
    }

    // Update the table with fetched scores
    function updateTable(scores) {
      const tableBody = document.querySelector('#scoreTable tbody');
      tableBody.innerHTML = ''; // Clear the table body before adding new data

      scores.forEach(score => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${score.week}</td>
          <td>${score.ande}</td>
          <td>${score.tom}</td>
        `;
        tableBody.appendChild(row);
      });
    }

    // Calculate the winner based on scores
    function calculateWinner(scores) {
      let andeTotal = 0, tomTotal = 0;
      scores.forEach(score => {
        andeTotal += parseInt(score.ande, 10);
        tomTotal += parseInt(score.tom, 10);
      });

      const winnerDisplay = document.querySelector('#winnerDisplay');
      if (andeTotal > tomTotal) {
        winnerDisplay.textContent = `🔥 Ande is leading with ${andeTotal} points!`;
      } else if (tomTotal > andeTotal) {
        winnerDisplay.textContent = `🎯 Tom is leading with ${tomTotal} points!`;
      } else {
        winnerDisplay.textContent = 'It\'s a tie!';
      }
    }

    // Call the fetch function when the page loads
    window.onload = fetchScores;
  </script>
</body>
</html>
